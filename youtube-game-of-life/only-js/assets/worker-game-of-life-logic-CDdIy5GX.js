var S=r=>{throw TypeError(r)};var z=(r,o,s)=>o.has(r)||S("Cannot "+s);var t=(r,o,s)=>(z(r,o,"read from private field"),s?s.call(r):o.get(r)),b=(r,o,s)=>o.has(r)?S("Cannot add the same private member more than once"):o instanceof WeakSet?o.add(r):o.set(r,s),f=(r,o,s,y)=>(z(r,o,"write to private field"),y?y.call(r,s):o.set(r,s),s),F=(r,o,s)=>(z(r,o,"access private method"),s);var M=(r,o,s,y)=>({set _(a){f(r,o,a,s)},get _(){return t(r,o,y)}});(function(){"use strict";var s,y,a,d,p,g,n,T,j,L,V,$;class r{constructor(){b(this,n);b(this,s,0);b(this,y,!1);b(this,a,new Map);b(this,d,new Map);b(this,p,10);b(this,g,10)}get activeCells(){return t(this,s)}get field(){return t(this,a)}get buffer(){return t(this,d)}get rows(){return t(this,p)}get cols(){return t(this,g)}initFields(i,e,l){return f(this,p,e),f(this,g,l),f(this,y,i),F(this,n,T).call(this,i),{cols:this.cols,rows:this.rows,activeCells:this.activeCells,field:this.field,buffer:this.buffer}}updateField(){return F(this,n,V).call(this),{cols:this.cols,rows:this.rows,activeCells:this.activeCells,field:this.field,buffer:this.buffer}}deleteOrCreateCell(i,e){i==="delete"?(M(this,s)._--,t(this,a).set(e,!1)):i==="create"&&(M(this,s)._++,t(this,a).set(e,!0))}resizeField(i,e,l){return F(this,n,$).call(this,i,e,l),{cols:this.cols,rows:this.rows,activeCells:this.activeCells,field:this.field,buffer:this.buffer}}}s=new WeakMap,y=new WeakMap,a=new WeakMap,d=new WeakMap,p=new WeakMap,g=new WeakMap,n=new WeakSet,T=function(i){f(this,a,new Map),f(this,d,new Map),f(this,s,0);for(let e=0;e<t(this,p);e++)for(let l=0;l<t(this,g);l++){const h=F(this,n,j).call(this,e,l),v=Math.round(Math.random())===1,m=i===!0?v:!1;m===!0&&M(this,s)._++,t(this,a).set(h,m)}},j=function(i,e){return`${i}-${e}`},L=function(i,e){let l=0;for(let h=-1;h<=1;h++)for(let v=-1;v<=1;v++){if(h===0&&v===0)continue;const m=(i+h+t(this,p))%t(this,p),c=(e+v+t(this,g))%t(this,g),u=F(this,n,j).call(this,m,c);t(this,a).get(u)&&l++}return l},V=function(){f(this,s,0),f(this,d,new Map);for(let i=0;i<t(this,p);i++)for(let e=0;e<t(this,g);e++){const l=F(this,n,L).call(this,i,e),h=F(this,n,j).call(this,i,e);t(this,a).get(h)?l<2||l>3?t(this,d).set(h,!1):(M(this,s)._++,t(this,d).set(h,!0)):l===3?(M(this,s)._++,t(this,d).set(h,!0)):t(this,d).set(h,!1)}[M(this,a)._,M(this,d)._]=[t(this,d),t(this,a)]},$=function(i,e,l){if(i===t(this,p)&&e===t(this,g))return;const h=t(this,a),v=t(this,p),m=t(this,g);f(this,y,l),f(this,p,i),f(this,g,e),f(this,a,new Map),f(this,d,new Map),f(this,s,0);for(let c=0;c<i;c++)for(let u=0;u<e;u++){const C=F(this,n,j).call(this,c,u),k=h.get(C)||!1;k===!0&&M(this,s)._++,t(this,a).set(C,k)}if(i>v||e>m)for(let c=0;c<i;c++)for(let u=0;u<e;u++){const C=F(this,n,j).call(this,c,u);if(!h.has(C)){const k=Math.round(Math.random())===1,w=t(this,y)===!0?k:!1;w===!0&&M(this,s)._++,t(this,a).set(C,w)}}if(i<v||e<m){for(let c=0;c<i;c++)for(let u=0;u<e;u++){const C=F(this,n,j).call(this,c,u),k=!!h.get(C);k===!0&&M(this,s)._++,t(this,d).set(C,k)}f(this,a,t(this,d)),f(this,d,h)}};const o=new r;onmessage=function(O){const i=O.data,e=i.type,l=i.payload;if(e==="initFields"){const h=o.initFields(l.random,l.rows,l.cols);postMessage({type:"result: initFields",data:h})}else if(e==="updateField"){const h=o.updateField();postMessage({type:"result: updateField",data:h})}else if(e==="deleteOrCreateCell"){const h=o.deleteOrCreateCell(l.typeAction,l.key);postMessage({type:"result: deleteOrCreateCell",data:h})}else if(e==="resizeField"){const h=o.resizeField(l.newRows,l.newCols,l.random);postMessage({type:"result: resizeField",data:h})}}})();
