{"mappings":"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","sources":["youtube-game-of-life/only-ts/scripts/functions/request-interval.ts","youtube-game-of-life/only-ts/scripts/functions/restrict-input.ts","node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/runtime-bebd07d7ca768569.js","node_modules/@parcel/runtime-js/lib/helpers/get-worker-url.js","node_modules/@parcel/runtime-js/lib/runtime-46626da0dc525a86.js","youtube-game-of-life/only-ts/scripts/index.ts","youtube-game-of-life/only-ts/scripts/game-of-life.ts"],"sourcesContent":["export function requestInterval(fn: () => void, interval: number = 0): {id: number} {\n  const obj = {\n    id: 0,\n  };\n  let start = Date.now();\n\n  const animate = () => {\n\t\tif (interval === 0) {\n\t\t\tfn();\n\t\t\tobj.id = requestAnimationFrame(animate);\n\t\t\treturn;\n\t\t}\n\n\n    const now = Date.now();\n    const delta = now - start;\n\n    if (delta >= interval) {\n      fn();\n      start = now - (delta % interval);\n    }\n\n    obj.id = requestAnimationFrame(animate);\n  };\n\n  obj.id = requestAnimationFrame(animate);\n\n  return obj;\n}\n","export function restrictInputValue(input: HTMLInputElement, min: number, max: number) {\n\tlet value = parseInt(input.value);\n\n\tif (isNaN(value)) {\n\t\tvalue = min;\n\t} else if (value < min) {\n\t\tvalue = min;\n\t} else if (value > max) {\n\t\tvalue = max;\n\t}\n\n\tinput.value = value.toString();\n\n\treturn value;\n}\n","\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"kAqiv\\\":\\\"index.947c17b6.js\\\",\\\"3aufl\\\":\\\"worker-game-of-life-logic.79a61d9a.js\\\"}\"));","\"use strict\";\n\nmodule.exports = function (workerUrl, origin, isESM) {\n  if (origin === self.location.origin) {\n    // If the worker bundle's url is on the same origin as the document,\n    // use the worker bundle's own url.\n    return workerUrl;\n  } else {\n    // Otherwise, create a blob URL which loads the worker bundle with `importScripts`.\n    var source = isESM ? 'import ' + JSON.stringify(workerUrl) + ';' : 'importScripts(' + JSON.stringify(workerUrl) + ');';\n    return URL.createObjectURL(new Blob([source], {\n      type: 'application/javascript'\n    }));\n  }\n};","let workerURL = require('./helpers/get-worker-url');\nlet url = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"3aufl\"));\nmodule.exports = workerURL(url.toString(), url.origin, true);","import { GameOfLife } from \"./game-of-life\";\n\nconst injectedNode = document.querySelector<HTMLElement>('.injected-game-life');\n\nif (injectedNode === null) {\n\tthrow new Error('injectedNode не найден');\n}\n\nconst game = new GameOfLife({\n\tcellsCountX: 100,\n\tcellsCountY: 100,\n\trandom: false,\n\tspeed: 1,\n\tlocalStorageUse: true,\n\tpopupHidden: false,\n\tinjectedNode: injectedNode\n});\n","import { GameOfLifeLocalStorage, GameOfLifeNodes, GameOfLifeParams, GameOfLifeWorkerResult } from \"../interfacesOrTypes\";\nimport { requestInterval } from \"./functions/request-interval\";\nimport { restrictInputValue } from \"./functions/restrict-input\";\n\nexport class GameOfLife {\n\tprivate ctx: CanvasRenderingContext2D;\n\tprivate rows: number;\n\tprivate cols: number;\n\tprivate cellSize: number;\n\tprivate field: Map<string, boolean>;\n\tprivate buffer: Map<string, boolean>;\n\tprivate colorCell: string;\n\tprivate animationObj: { id: number };\n\tprivate nodes: GameOfLifeNodes;\n\tprivate cycles: number = 0;\n\tprivate played: boolean = false;\n\tprivate interval: number = 500;\n\tprivate gameTime: number = 0;\n\tprivate gameStartTime: number = 0;\n\tprivate gameLastTime: number = 0;\n\tprivate random: boolean = false;\n\tprivate speed: number = 0;\n\tprivate activeCells: number = 0;\n\tprivate localStorageUse: boolean = false;\n\tprivate isDragging: boolean = false;\n\tprivate isRealDragging: boolean = false;\n\tprivate animationTimeId: { id: number };\n\tprivate worker: Worker = new Worker(new URL('workers/worker-game-of-life-logic.js', import.meta.url));\n\tprivate loading: boolean = false;\n\tprivate focusedInput: HTMLInputElement | null = null;\n\tprivate popupHidden: boolean = false;\n\n\tconstructor({ injectedNode, cellsCountX, cellsCountY, random, speed, localStorageUse, popupHidden }: GameOfLifeParams) {\n\t\tif (speed < 1) {\n\t\t\tthrow new Error('GameOfLife: speed не может быть меньше 1');\n\t\t}\n\t\tif (speed > 10) {\n\t\t\tthrow new Error('GameOfLife: speed не может быть больше 10');\n\t\t}\n\n\t\tthis.rows = cellsCountX;\n\t\tthis.cols = cellsCountY;\n\t\tthis.random = random;\n\t\tthis.speed = speed;\n\t\tthis.localStorageUse = localStorageUse;\n\t\tthis.popupHidden = popupHidden;\n\n\t\tthis.initNodes(injectedNode);\n\t\tthis.ctx = this.nodes.canvasNode.getContext(\"2d\")!;\n\t\tif (this.localStorageUse) this.useLocalStorage();\n\t\tthis.initCalcSpeed();\n\t\tthis.setCanvasSize();\n\t\tthis.setColorCell();\n\t\tthis.initInputNodes();\n\t\tthis.initPopupHidden();\n\n\t\tthis.sendWorkerInitFields({\n\t\t\trandom: this.random,\n\t\t\trows: this.rows,\n\t\t\tcols: this.cols\n\t\t})\n\t\t.then(({ activeCells, field, buffer }) => {\n\t\t\tthis.initEventListeners();\n\t\t\tthis.drawField();\n\t\t\tthis.renderPopup();\n\t\t});\n\t}\n\n\tprivate initInputNodes(): void {\n\t\tthis.nodes.popupInputRowsNode.value = String(this.rows);\n\t\tthis.nodes.popupInputColsNode.value = String(this.cols);\n\t}\n\n\tprivate initPopupHidden(): void {\n\t\tthis.togglePopup(this.popupHidden);\n\t}\n\n\tprivate disableInputs(): void {\n\t\tthis.nodes.popupInputRowsNode.disabled = true;\n\t\tthis.nodes.popupInputColsNode.disabled = true;\n\t}\n\n\tprivate enableInputs(): void {\n\t\tthis.nodes.popupInputRowsNode.disabled = false;\n\t\tthis.nodes.popupInputColsNode.disabled = false;\n\n\t\tif (this.focusedInput !== null) {\n\t\t\tthis.focusedInput.focus();\n\t\t\tthis.focusedInput = null;\n\t\t}\n\t}\n\n\tprivate sendWorkerInitFields({\n\t\trandom, rows, cols\n\t}: { random: boolean; rows: number; cols: number }): Promise<GameOfLifeWorkerResult> {\n\n\t\tthis.load();\n\t\tthis.disableInputs();\n\n\t\tthis.worker.postMessage({\n\t\t\ttype: 'initFields',\n\t\t\tpayload: {\n\t\t\t\trandom: random,\n\t\t\t\trows: rows,\n\t\t\t\tcols: cols\n\t\t\t}\n\t\t});\n\n\t\tconst resultWorker = new Promise<GameOfLifeWorkerResult>((resolve, reject) => {\n\t\t\tthis.worker.onmessage = (event) => {\n\t\t\t\tconst message = event.data;\n\n\t\t\t\tthis.loadComplete();\n\t\t\t\tthis.enableInputs();\n\n\t\t\t\tif (message.type === 'result: initFields') {\n\t\t\t\t\tconst data: GameOfLifeWorkerResult = message.data;\n\t\t\t\t\tconst { activeCells, field, buffer } = data;\n\n\t\t\t\t\tthis.activeCells = activeCells;\n\t\t\t\t\tthis.field = field;\n\t\t\t\t\tthis.buffer = buffer;\n\n\t\t\t\t\tresolve(data);\n\t\t\t\t}\n\n\t\t\t\treject(false);\n\t\t\t};\n\t\t});\n\n\t\treturn resultWorker;\n\t}\n\n\tprivate load(): void {\n\t\tthis.loading = true;\n\t\tthis.nodes.popupLoadNode.classList.add('popup__load_active');\n\t\tthis.nodes.popupNode.classList.add('popup_load');\n\t}\n\n\tprivate loadComplete(): void {\n\t\tthis.loading = false;\n\t\tthis.nodes.popupLoadNode.classList.remove('popup__load_active');\n\t\tthis.nodes.popupNode.classList.remove('popup_load');\n\t}\n\n\tprivate initEventListeners(): void {\n\t\twindow.addEventListener('resize', this.resizeAndDraw);\n\t\tconst matchMediaDark = window.matchMedia('(prefers-color-scheme: dark)');\n\n\t\tmatchMediaDark.addEventListener('change', this.setColorCellAndDraw);\n\n\t\tthis.nodes.popupPauseNode.addEventListener('click', () => {\n\t\t\tif (this.played === false) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.stopGame();\n\t\t});\n\n\t\tthis.nodes.popupPlayNode.addEventListener('click', () => {\n\t\t\tif (this.played === true) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.startGame();\n\t\t});\n\n\t\tthis.nodes.popupGenerateNode.addEventListener('click', this.generateNewFields);\n\n\t\tthis.nodes.canvasNode.addEventListener('pointerdown', (event) => {\n\t\t\tif (this.loading === true) return;\n\t\t\tif (event.button === 2 || event.button === 1) return false; // Если это правая или средняя кнопка мыши, это не тот клик\n\t\t\tthis.isDragging = true;\n\t\t\tthis.isRealDragging = false;\n\t\t});\n\n\t\tthis.nodes.canvasNode.addEventListener('pointermove', (event) => {\n\t\t\tif (event.button === 2 || event.button === 1) return false; // Если это правая или средняя кнопка мыши, это не тот клик\n\t\t\tif (this.isDragging === true && this.loading === false) {\n\t\t\t\tthis.isRealDragging = true;\n\t\t\t\tthis.generateCellByClick(event, true)\n\t\t\t};\n\t\t});\n\n\t\tdocument.addEventListener('pointerup', (event) => {\n\t\t\tif (event.button === 2 || event.button === 1) return false; // Если это правая или средняя кнопка мыши, это не тот клик\n\t\t\tconst clickOnPopupBool = this.isClickOnElement(event, this.nodes.popupNode);\n\t\t\tif (clickOnPopupBool === true) return;\n\t\t\tif (this.isRealDragging === false && this.loading === false) this.generateCellByClick(event, false);\n\n\t\t\tthis.isDragging = false;\n\t\t\tthis.isRealDragging = false;\n\t\t});\n\n\t\tthis.nodes.popupRandomCheckboxNode.addEventListener('input', () => {\n\t\t\tthis.random = !this.random;\n\t\t\tif (this.localStorageUse) this.setLocalStorage('random', this.random);\n\t\t\tthis.renderRandom();\n\t\t});\n\n\t\tthis.nodes.popupSpeedRangeNode.addEventListener('input', this.calcSpeedInputChange);\n\t\tthis.nodes.popupClearNode.addEventListener('click', this.clear);\n\n\t\tthis.nodes.popupStepNode.addEventListener('click', () => {\n\t\t\tthis.disableInputs();\n\t\t\tthis.stepGame()?.then(data => {\n\t\t\t\tthis.enableInputs();\n\t\t\t});\n\t\t});\n\n\t\tthis.nodes.popupInputRowsNode.addEventListener('input', () => {\n\t\t\tconst newRows = restrictInputValue(this.nodes.popupInputRowsNode, 0, 2000);\n\t\t\tif (this.localStorageUse) this.setLocalStorage('rows', newRows);\n\n\t\t\tthis.focusedInput = this.nodes.popupInputRowsNode;\n\t\t\tthis.resizeFieldRows(newRows);\n\t\t});\n\n\t\tthis.nodes.popupInputColsNode.addEventListener('input', () => {\n\t\t\tconst newCols = restrictInputValue(this.nodes.popupInputColsNode, 0, 2000);\n\t\t\tif (this.localStorageUse) this.setLocalStorage('cols', newCols);\n\n\t\t\tthis.focusedInput = this.nodes.popupInputColsNode;\n\t\t\tthis.resizeFieldCols(newCols);\n\t\t});\n\n\t\tthis.nodes.popupCloseNode.addEventListener('click', () => {\n\t\t\tthis.popupHidden = !this.popupHidden;\n\t\t\tthis.togglePopup(this.popupHidden);\n\t\t});\n\t}\n\n\tprivate togglePopup = (popupHidden: boolean): void => {\n\t\tif (this.localStorageUse === true) this.setLocalStorage('popupHidden', this.popupHidden);\n\n\t\tif (this.popupHidden === true) {\n\t\t\tthis.nodes.popupNode.classList.add('popup_hidden');\n\t\t\tthis.nodes.popupCloseNode.textContent = 'Открыть';\n\t\t} else {\n\t\t\tthis.nodes.popupNode.classList.remove('popup_hidden');\n\t\t\tthis.nodes.popupCloseNode.textContent = 'Скрыть';\n\t\t}\n\t}\n\n\tprivate resizeFieldRows(newRows: number): void {\n\t\tif (this.loading === true) return;\n\n\t\tthis.sendWorkerResizeField(newRows, this.cols, this.random)\n\t\t.then((data) => {\n\t\t\tthis.setCanvasSize();\n\t\t\tthis.drawField();\n\t\t\tthis.renderTime();\n\t\t\tthis.renderPopup();\n\t\t});\n\t}\n\n\tprivate resizeFieldCols(newCols: number): void {\n\t\tif (this.loading === true) return;\n\n\t\tthis.sendWorkerResizeField(this.rows, newCols, this.random)\n\t\t.then((data) => {\n\t\t\tthis.setCanvasSize();\n\t\t\tthis.drawField();\n\t\t\tthis.renderTime();\n\t\t\tthis.renderPopup();\n\t\t});\n\t}\n\n\tprivate sendWorkerResizeField(newRows: number, newCols: number, random: boolean): Promise<void | GameOfLifeWorkerResult> {\n\t\tthis.load();\n\t\tthis.disableInputs();\n\n\t\tthis.worker.postMessage({\n\t\t\ttype: 'resizeField',\n\t\t\tpayload: {\n\t\t\t\tnewRows: newRows,\n\t\t\t\tnewCols: newCols,\n\t\t\t\trandom: random\n\t\t\t}\n\t\t});\n\n\t\tconst resultWorker = new Promise<GameOfLifeWorkerResult>((resolve, reject) => {\n\t\t\tthis.worker.onmessage = (event) => {\n\t\t\t\tconst message = event.data;\n\n\t\t\t\tthis.loadComplete();\n\t\t\t\tthis.enableInputs();\n\n\n\t\t\t\tif (message.type === 'result: resizeField') {\n\t\t\t\t\tconst data: GameOfLifeWorkerResult = message.data;\n\t\t\t\t\tconst { field, buffer, activeCells, rows, cols } = data;\n\n\t\t\t\t\tthis.field = field;\n\t\t\t\t\tthis.buffer = buffer;\n\t\t\t\t\tthis.activeCells = activeCells;\n\t\t\t\t\tthis.rows = rows;\n\t\t\t\t\tthis.cols = cols;\n\n\t\t\t\t\tresolve(data);\n\t\t\t\t}\n\n\t\t\t\treject(false);\n\t\t\t};\n\t\t}).catch(() => {});\n\n\t\treturn resultWorker;\n\t}\n\n\tprivate isClickOnElement(event: MouseEvent, element: Element): boolean {\n\t\tconst target = event.target as Element; // Получаем целевой элемент клика\n\n\t\t// Проверяем, является ли целевой элемент или его родительские элементы равным заданному элементу\n\t\tlet currentNode: Element | null = target;\n\t\twhile (currentNode != null) {\n\t\t\tif (currentNode === element) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tcurrentNode = currentNode.parentElement;\n\t\t}\n\n\t\t// Если не было найдено совпадений, возвращаем false\n\t\treturn false;\n\t}\n\n\tprivate sendWorkerDeleteOrCreateCell(typeAction: 'delete' | 'create', key: string): Promise<GameOfLifeWorkerResult> {\n\t\tthis.load();\n\n\t\tthis.worker.postMessage({\n\t\t\ttype: 'deleteOrCreateCell',\n\t\t\tpayload: {\n\t\t\t\ttypeAction: typeAction,\n\t\t\t\tkey: key\n\t\t\t}\n\t\t});\n\n\t\tconst resultWorker = new Promise<GameOfLifeWorkerResult>((resolve, reject) => {\n\t\t\tthis.worker.onmessage = (event) => {\n\t\t\t\tconst message = event.data;\n\n\t\t\t\tthis.loadComplete();\n\n\t\t\t\tif (message.type === 'result: deleteOrCreateCell') {\n\t\t\t\t\tconst data: GameOfLifeWorkerResult = message.data;\n\t\t\t\t\tresolve(data);\n\t\t\t\t}\n\n\t\t\t\treject(false);\n\t\t\t};\n\t\t});\n\n\t\treturn resultWorker;\n\t}\n\n\tprivate generateCellByClick = (event: MouseEvent, moved: boolean = false): void => {\n\t\tif (this.played === true) {\n\t\t\treturn;\n\t\t}\n\t\tconst rect = this.nodes.canvasNode.getBoundingClientRect();\n\t\tconst x = event.clientX - rect.left;\n\t\tconst y = event.clientY - rect.top;\n\t\tconst col = Math.floor(x / this.cellSize);\n\t\tconst row = Math.floor(y / this.cellSize);\n\t\tconst key = this.getKey(row, col);\n\n\t\tconst isCellAlive = this.field.get(key);\n\n\t\tconst deleteCell = () => {\n\t\t\tthis.activeCells--;\n\t\t\tthis.field.set(key, false);\n\t\t\tthis.sendWorkerDeleteOrCreateCell('delete', key).then();\n\t\t};\n\n\t\tconst createCell = () => {\n\t\t\tthis.activeCells++;\n\t\t\tthis.field.set(key, true);\n\t\t\tthis.sendWorkerDeleteOrCreateCell('create', key).then();\n\t\t}\n\n\t\tif (isCellAlive === false && moved === true) {\n\t\t\tcreateCell();\n\t\t} else if (isCellAlive === false && moved === false) {\n\t\t\tcreateCell();\n\t\t} else if (isCellAlive === true && moved === false) {\n\t\t\tdeleteCell();\n\t\t}\n\n\t\tthis.renderPopulation();\n\t\tthis.drawField();\n\t}\n\n\tprivate initCalcSpeed(): void {\n\t\tconst max = Number(this.nodes.popupSpeedRangeNode.max);\n\t\tconst min = Number(this.nodes.popupSpeedRangeNode.min);\n\n\t\tconst speedPercent = (this.speed - 1) / 9;\n\t\tconst value = min + (speedPercent * (max - min));\n\n\t\tthis.nodes.popupSpeedRangeNode.value = String(value);\n\t\tthis.nodes.popupSpeedInfoNode.textContent = String(this.speed);\n\t}\n\n\tprivate calcSpeedInputChange = (): void => {\n\t\tconst lastGameState = this.played;\n\t\tthis.stopGame();\n\n\t\tconst currentVal = this.nodes.popupSpeedRangeNode.valueAsNumber;\n\t\tconst max = Number(this.nodes.popupSpeedRangeNode.max);\n\t\tconst min = Number(this.nodes.popupSpeedRangeNode.min);\n\n\t\tconst end = max - min;\n\t\tconst currentValMod = currentVal - min;\n\n\t\tconst currentValPercent = currentValMod / end;\n\t\tconst newSpeed = Number(((currentValPercent * 9) + 1).toFixed(1));\n\t\tthis.speed = newSpeed;\n\n\t\tthis.nodes.popupSpeedInfoNode.textContent = String(this.speed);\n\n\t\tif (this.localStorageUse) this.setLocalStorage('speed', this.speed);\n\n\t\tif (lastGameState === true) this.startGame();\n\t}\n\n\tprivate useLocalStorage(): void {\n\t\tconst lastLocalStorage = this.getLocalStorage();\n\n\t\tif (lastLocalStorage.random !== undefined) {\n\t\t\tthis.random = lastLocalStorage.random;\n\t\t}\n\n\t\tif (lastLocalStorage.speed !== undefined) {\n\t\t\tthis.speed = lastLocalStorage.speed;\n\t\t}\n\n\t\tif (lastLocalStorage.rows !== undefined) {\n\t\t\tthis.rows = lastLocalStorage.rows;\n\t\t}\n\n\t\tif (lastLocalStorage.cols !== undefined) {\n\t\t\tthis.cols = lastLocalStorage.cols;\n\t\t}\n\n\t\tif (lastLocalStorage.popupHidden !== undefined) {\n\t\t\tthis.popupHidden = lastLocalStorage.popupHidden;\n\t\t}\n\t}\n\n\tprivate clear = (): void => {\n\t\tif (this.loading === true) false;\n\n\t\tthis.stopGame();\n\t\tthis.gameTime = 0;\n\t\tthis.gameLastTime = 0;\n\t\tthis.gameStartTime = 0;\n\t\tthis.cycles = 0;\n\n\t\tthis.disableInputs();\n\n\t\tthis.sendWorkerInitFields({\n\t\t\trandom: false,\n\t\t\trows: this.rows,\n\t\t\tcols: this.cols\n\t\t}).then(data => {\n\t\t\tthis.drawField();\n\t\t\tthis.renderTime();\n\t\t\tthis.renderPopup();\n\t\t\tthis.enableInputs();\n\t\t});\n\t}\n\n\tprivate generateNewFields = (): void => {\n\t\tif (this.loading === true) false;\n\n\t\tthis.sendWorkerInitFields({\n\t\t\trandom: true,\n\t\t\trows: this.rows,\n\t\t\tcols: this.cols\n\t\t}).then(data => {\n\t\t\tthis.cycles = 0;\n\t\t\tthis.drawField();\n\t\t\tthis.renderPopup();\n\t\t});\n\t}\n\n\tprivate initNodes(injectedNode: HTMLElement): void {\n\n\t\tinjectedNode.innerHTML = `\n\t\t\t<div class=\"wrapper\">\n\t\t\t\t<div class=\"wrapper-canvas\">\n\t\t\t\t\t<canvas class=\"canvas\"></canvas>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"popup\">\n\t\t\t\t\t<div class=\"popup__item popup__play\">Play</div>\n\t\t\t\t\t<div class=\"popup__item popup__pause\">Пауза</div>\n\t\t\t\t\t<div class=\"popup__item popup__clear\">Очистить</div>\n\t\t\t\t\t<div class=\"popup__item popup__step\">Шаг</div>\n\t\t\t\t\t<div class=\"popup__item popup__generate\">Сгенерировать</div>\n\t\t\t\t\t<label class=\"popup__item popup__random-checkbox-item\">\n\t\t\t\t\t\t<input type=\"checkbox\" class=\"popup__random-checkbox\">\n\t\t\t\t\t\t<span>Рандом</span>\n\t\t\t\t\t</label>\n\t\t\t\t\t<div class=\"popup__item\">\n\t\t\t\t\t\tВремя:\n\t\t\t\t\t\t<span class=\"popup__time\">0.0</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"popup__item\">Поколение: <span class=\"popup__cycles\">0</span></div>\n\t\t\t\t\t<div class=\"popup__item\">Население: <span class=\"popup__population\">0</span></div>\n\t\t\t\t\t<div class=\"popup__item\">\n\t\t\t\t\t\t<span>Скорость: </span>\n\t\t\t\t\t\t<span class=\"popup__speed-info\">1</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"popup__item\">\n\t\t\t\t\t\t<input class=\"popup__speed-range\" type=\"range\" min=\"0\" max=\"100\" value=\"50\">\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"popup__item popup__item_inputs\">\n\t\t\t\t\t\t<input type=\"number\" class=\"popup__rows popup__inputs\" placeholder=\"rows\" min=\"0\" max=\"2000\">\n\t\t\t\t\t\t<input type=\"number\" class=\"popup__cols popup__inputs\" placeholder=\"cols\" min=\"0\" max=\"2000\">\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"popup__item popup__close\">Скрыть</div>\n\n\t\t\t\t\t<div class=\"popup__item popup__load\">Загрузка</div>\n\n\t\t\t\t</div>\n\n\t\t\t</div>\n\t\t`;\n\n\t\tconst popupNode = this._querySelector<HTMLElement>(injectedNode, '.popup');\n\t\tconst canvasNode = this._querySelector<HTMLCanvasElement>(injectedNode, '.canvas');\n\t\tconst wrapperCanvasNode = this._querySelector<HTMLElement>(injectedNode, '.wrapper-canvas');\n\t\tconst popupPlayNode = this._querySelector<HTMLElement>(popupNode, '.popup__play');\n\t\tconst popupPauseNode = this._querySelector<HTMLElement>(popupNode, '.popup__pause');\n\t\tconst popupTimeNode = this._querySelector<HTMLElement>(popupNode, '.popup__time');\n\t\tconst popupPopulationNode = this._querySelector<HTMLElement>(popupNode, '.popup__population');\n\t\tconst popupCyclesNode = this._querySelector<HTMLElement>(popupNode, '.popup__cycles');\n\t\tconst popupGenerateNode = this._querySelector<HTMLElement>(popupNode, '.popup__generate');\n\t\tconst popupRandomCheckboxNode = this._querySelector<HTMLInputElement>(popupNode, '.popup__random-checkbox');\n\t\tconst popupSpeedRangeNode = this._querySelector<HTMLInputElement>(popupNode, '.popup__speed-range');\n\t\tconst popupSpeedInfoNode = this._querySelector<HTMLElement>(popupNode, '.popup__speed-info');\n\t\tconst popupClearNode = this._querySelector<HTMLElement>(popupNode, '.popup__clear');\n\t\tconst popupStepNode = this._querySelector<HTMLElement>(popupNode, '.popup__step');\n\t\tconst popupLoadNode = this._querySelector<HTMLElement>(popupNode, '.popup__load');\n\t\tconst popupInputRowsNode = this._querySelector<HTMLInputElement>(popupNode, '.popup__rows');\n\t\tconst popupInputColsNode = this._querySelector<HTMLInputElement>(popupNode, '.popup__cols');\n\t\tconst popupCloseNode = this._querySelector<HTMLInputElement>(popupNode, '.popup__close');\n\n\t\tthis.nodes = {\n\t\t\tcanvasNode: canvasNode,\n\t\t\tpopupNode: popupNode,\n\t\t\tpopupPlayNode: popupPlayNode,\n\t\t\tpopupPauseNode: popupPauseNode,\n\t\t\tpopupTimeNode: popupTimeNode,\n\t\t\tpopupPopulationNode: popupPopulationNode,\n\t\t\tpopupCyclesNode: popupCyclesNode,\n\t\t\tpopupGenerateNode: popupGenerateNode,\n\t\t\twrapperCanvasNode: wrapperCanvasNode,\n\t\t\tpopupRandomCheckboxNode: popupRandomCheckboxNode,\n\t\t\tpopupSpeedRangeNode: popupSpeedRangeNode,\n\t\t\tpopupSpeedInfoNode: popupSpeedInfoNode,\n\t\t\tpopupClearNode: popupClearNode,\n\t\t\tpopupStepNode: popupStepNode,\n\t\t\tpopupLoadNode: popupLoadNode,\n\t\t\tpopupInputRowsNode: popupInputRowsNode,\n\t\t\tpopupInputColsNode: popupInputColsNode,\n\t\t\tpopupCloseNode: popupCloseNode\n\t\t}\n\t}\n\n\tprivate _querySelector<T = Element>(parentNode: Element | Document, selector: string): T {\n\t\tconst node = parentNode.querySelector(selector);\n\t\tif (node === null) {\n\t\t\tthrow new Error(`GameOfLife: элемент с классом ${selector} не найден`);\n\t\t}\n\t\treturn node as T;\n\t}\n\n\n\tprivate resizeAndDraw = (): void => {\n\t\tthis.setCanvasSize();\n\t\tthis.drawField();\n\t}\n\n\tprivate setColorCell = (): void => {\n\t\tthis.colorCell = getComputedStyle(document.documentElement).getPropertyValue('--color');\n\t}\n\n\tprivate setColorCellAndDraw = (): void => {\n\t\tthis.setColorCell();\n\t\tthis.drawField();\n\t}\n\n\tprivate setCanvasSize = (): void => {\n\t\tconst width = this.nodes.wrapperCanvasNode.offsetWidth;\n\t\tconst height = this.nodes.wrapperCanvasNode.offsetHeight;\n\n\t\tconst aspectRatio = this.cols / this.rows;\n\n\t\tconst canvasWidth = Math.min(width, height * aspectRatio);\n\t\tconst canvasHeight = canvasWidth / aspectRatio;\n\n\t\tthis.cellSize = canvasWidth / this.cols;\n\n\t\tconst xPadding = (width - canvasWidth) / 2;\n\t\tconst yPadding = (height - canvasHeight) / 2;\n\n\t\tthis.nodes.canvasNode.width = canvasWidth;\n\t\tthis.nodes.canvasNode.height = canvasHeight;\n\n\t\tthis.nodes.wrapperCanvasNode.style.padding = `${yPadding}px ${xPadding}px`;\n\t}\n\n\tprivate getKey(row: number, col: number): string {\n\t\treturn `${row}-${col}`;\n\t}\n\n\tprivate drawField(): void {\n\t\tthis.load();\n\n\t\tthis.ctx.clearRect(0, 0, this.nodes.canvasNode.width, this.nodes.canvasNode.height);\n\t\tconst cellSize = this.cellSize;\n\n\t\tthis.ctx.fillStyle = this.colorCell;\n\n\t\tfor (let i = 0; i < this.rows; i++) {\n\t\t\tfor (let j = 0; j < this.cols; j++) {\n\t\t\t\tconst key = this.getKey(i, j);\n\t\t\t\tif (this.field.get(key)) {\n\t\t\t\t\tthis.ctx.fillRect(j * cellSize, i * cellSize, cellSize, cellSize);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.loadComplete();\n\t}\n\n\tprivate sendWorkerUpdateField(): Promise<GameOfLifeWorkerResult> {\n\t\tthis.load();\n\n\t\tthis.worker.postMessage({\n\t\t\ttype: 'updateField',\n\t\t\tpayload: {}\n\t\t});\n\n\t\tconst resultWorker = new Promise<GameOfLifeWorkerResult>((resolve, reject) => {\n\t\t\tthis.worker.onmessage = (event) => {\n\t\t\t\tconst message = event.data;\n\n\t\t\t\tthis.loadComplete();\n\n\t\t\t\tif (message.type === 'result: updateField') {\n\t\t\t\t\tconst data: GameOfLifeWorkerResult = message.data;\n\t\t\t\t\tconst { activeCells, field, buffer } = data;\n\n\t\t\t\t\tthis.activeCells = activeCells;\n\t\t\t\t\tthis.field = field;\n\t\t\t\t\tthis.buffer = buffer;\n\n\t\t\t\t\tresolve(data);\n\t\t\t\t}\n\n\t\t\t\treject(false);\n\t\t\t};\n\t\t});\n\n\t\treturn resultWorker;\n\t}\n\n\tprivate renderPopup(): void {\n\t\tthis.renderPopulation();\n\t\tthis.renderRandom();\n\t\tthis.nodes.popupCyclesNode.textContent = String(this.cycles);\n\t\tthis.nodes.popupRandomCheckboxNode.checked = this.random;\n\t}\n\n\tprivate renderTime(): void {\n\t\tlet gameTime = Date.now() - this.gameStartTime + this.gameLastTime;\n\t\tif (this.gameStartTime === 0) gameTime = 0;\n\t\tthis.gameTime = gameTime;\n\n\t\tthis.nodes.popupTimeNode.textContent = (this.gameTime / 1000).toFixed(1);\n\t}\n\n\tprivate renderRandom(): void {\n\t\tif (this.random === true) {\n\t\t\tthis.nodes.popupGenerateNode.classList.add('popup__generate_active');\n\t\t} else {\n\t\t\tthis.nodes.popupGenerateNode.classList.remove('popup__generate_active');\n\t\t}\n\t}\n\n\tprivate renderPopulation(): void {\n\t\tthis.nodes.popupPopulationNode.textContent = String(this.activeCells);\n\t}\n\n\tprivate stepGame = (): Promise<GameOfLifeWorkerResult> | undefined => {\n\t\tif (this.loading === true) return;\n\n\t\treturn this.sendWorkerUpdateField()\n\t\t.then(data => {\n\t\t\tthis.drawField();\n\t\t\tthis.cycles = this.cycles + 1;\n\t\t\tthis.renderPopup();\n\t\t\treturn data;\n\t\t});\n\t}\n\n\tprivate startGame(): void {\n\t\tthis.disableInputs();\n\t\tthis.played = true;\n\t\tthis.gameStartTime = Date.now();\n\t\tthis.animationObj = requestInterval(this.stepGame, this.interval / this.speed ** 1.5);\n\t\tthis.animationTimeId = requestInterval(this.stepAnimationRenderTime);\n\t}\n\n\tprivate stepAnimationRenderTime = () => {\n\t\tthis.renderTime();\n\t}\n\n\tpublic stopGame(): void {\n\t\tif (this.played === false) return;\n\t\tthis.played = false;\n\t\tthis.gameLastTime = this.gameTime;\n\t\tcancelAnimationFrame(this.animationObj.id);\n\t\tcancelAnimationFrame(this.animationTimeId.id);\n\t\tthis.enableInputs();\n\t}\n\n\tprivate getLocalStorage(): GameOfLifeLocalStorage {\n\t\treturn JSON.parse(localStorage.getItem('life') || '{}');\n\t}\n\n\tprivate setLocalStorage<T>(key: string, value: T): void {\n\t\tconst lastLocalStorage = this.getLocalStorage();\n\n\t\tlastLocalStorage[key] = value;\n\n\t\tlocalStorage.setItem('life', JSON.stringify(lastLocalStorage));\n\t}\n\n}\n\n\n"],"names":["$20713660892d2e93$export$281c8d11e819ea94","fn","interval","obj","id","start","Date","now","animate","requestAnimationFrame","delta","$d7cbbf251e962942$export$7913c0f032ea53bb","input","min","max","value","parseInt","isNaN","toString","$18c11f3350a906ea$export$6503ec6e8aabbaf","$18c11f3350a906ea$export$f7ad0328861e2f03","$18c11f3350a906ea$var$mapping","pairs","keys","Object","i","length","resolved","Error","parcelRequire","register","JSON","parse","$56b621a6dd25b2cb$exports","workerUrl","origin","isESM","self","location","source","stringify","URL","createObjectURL","Blob","type","$bf724c28c7332a51$var$url","resolve","import","meta","url","$bf724c28c7332a51$exports","$b112110fd2ad031c$var$injectedNode","document","querySelector","cycles","played","gameTime","gameStartTime","gameLastTime","random","speed","activeCells","localStorageUse","isDragging","isRealDragging","worker","Worker","loading","focusedInput","popupHidden","constructor","injectedNode","cellsCountX","cellsCountY","this","rows","cols","initNodes","ctx","nodes","canvasNode","getContext","useLocalStorage","initCalcSpeed","setCanvasSize","setColorCell","initInputNodes","initPopupHidden","sendWorkerInitFields","then","field","buffer","initEventListeners","drawField","renderPopup","popupInputRowsNode","String","popupInputColsNode","togglePopup","disableInputs","disabled","enableInputs","focus","load","postMessage","payload","Promise","reject","onmessage","event","message","data","loadComplete","popupLoadNode","classList","add","popupNode","remove","window","addEventListener","resizeAndDraw","matchMedia","setColorCellAndDraw","popupPauseNode","stopGame","popupPlayNode","startGame","popupGenerateNode","generateNewFields","button","generateCellByClick","isClickOnElement","popupRandomCheckboxNode","setLocalStorage","renderRandom","popupSpeedRangeNode","calcSpeedInputChange","popupClearNode","clear","popupStepNode","stepGame","newRows","resizeFieldRows","newCols","resizeFieldCols","popupCloseNode","textContent","sendWorkerResizeField","renderTime","catch","element","currentNode","target","parentElement","sendWorkerDeleteOrCreateCell","typeAction","key","moved","rect","getBoundingClientRect","x","clientX","left","y","clientY","top","col","Math","floor","cellSize","row","getKey","isCellAlive","get","createCell","set","deleteCell","renderPopulation","Number","popupSpeedInfoNode","lastGameState","currentVal","valueAsNumber","newSpeed","toFixed","lastLocalStorage","getLocalStorage","undefined","innerHTML","_querySelector","wrapperCanvasNode","popupTimeNode","popupPopulationNode","popupCyclesNode","parentNode","selector","node","colorCell","getComputedStyle","documentElement","getPropertyValue","width","offsetWidth","height","offsetHeight","aspectRatio","canvasWidth","canvasHeight","xPadding","yPadding","style","padding","clearRect","fillStyle","j","fillRect","sendWorkerUpdateField","checked","animationObj","animationTimeId","stepAnimationRenderTime","cancelAnimationFrame","localStorage","getItem","setItem"],"version":3,"file":"index.947c17b6.js.map"}